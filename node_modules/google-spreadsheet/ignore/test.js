var async = require('async');

var GoogleSpreadsheet = require("./index.js");
var doc = new GoogleSpreadsheet('1saRApLme-qgAH0nyfg2mqPcm980nzKDg5kES0tS90rg');

// doc.getInfo(function(err, info){
//   if (err) return console.log(err);
//   console.log(info);
// });
// return;

var sheet;

async.waterfall([
  function connect(step){
    doc.useServiceAccountAuth(require('./test/service-account-creds'), step);
  },
  function info(step){
    doc.getInfo(step);
  },
  function read(info, step) {
    var sheet = info.worksheets[0]

    sheet.getRows(step);
  },
  function log(rows, step){
    console.log(rows);
    step();
  }
  // function addSheet(info, step) {
    // console.log(info);
    // doc.addWorksheet({title: 'Cell Feed'}, step);
  // },

  // function cells(info, step) {
  //   console.log(info);
  //   doc.getCells(2, {}, step);
  // },
  // function updateCells(cells, step){
  //   console.log(cells);
  //   cells[0].value = 1000
  //   cells[2].value = 5000
  //   cells[1].inputValue = '=A3'

  //   // cells[0].setValueAndSave(500, step);
  //   // cells[2].setValue(800);
  //   doc.bulkUpdateCells(2, cells, step);
  // }

  // function rows(info, step) {
  //   doc.getRows(1, step);
  // },
  // function update(rows, step) {
  //   rows[1].test = 'blueberries 44';
  //   rows[1].save(step)
  // }

  // function cells(info, step) {
  //   doc.getCells(1, {
  //     'min-row': 1,
  //     'max-row': 3,
  //     'min-col': 1,
  //     'max-col': 2,
  //     'return-empty': true
  //   }, step)
  // },
  // function update(cells, step) {
  //   console.log(cells);
  //   cells[3].setValue('moo', step);
  // }

], function(err, result){
  if (err) {
    console.log(err)
  }
  console.log('DONE');
  process.exit(0);
});
